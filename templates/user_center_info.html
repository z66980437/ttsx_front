{% extends 'base_main.html' %}

{% block title %}
    天天生鲜-用户中心
{% endblock %}


{% block js %}
    <script type="text/javascript" src="/static/js/jquery-1.12.4.min.js"></script>
{% endblock %}


{% block search %}
    {% load static %}
    <div class="search_bar clearfix">
		<a href="{% url 'goods:index' %}" class="logo fl"><img src="{% static 'images/logo.png' %}"></a>
		<div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;用户中心</div>
		<div class="search_con fr">
			<input type="text" class="input_text fl" name="" placeholder="搜索商品">
			<input type="button" class="input_btn fr" name="" value="搜索">
		</div>
	</div>
{% endblock %}


{% block content %}
    {% csrf_token %}
    <div class="main_con clearfix">
		<div class="left_menu_con clearfix">
			<h3>用户中心</h3>
			<ul>
				<li><a href="{% url 'user:info' %}" class="active">· 个人信息</a></li>
				<li><a href="/user/all_orders/1/">· 全部订单</a></li>
				<li><a href="/user/address/">· 收货地址</a></li>
			</ul>
		</div>
		<div class="right_content clearfix">
				<div class="info_con clearfix">
				<h3 class="common_title2">基本信息</h3>
						<ul class="user_info_list">
							<li><span>用户名：</span>{{ user.username }}</li>
							<li><span>联系方式：</span>{{ user.mobile }}</li>
							<li><span>邮箱地址：</span>{{ user.email }}</li>
						</ul>
				</div>

				<h3 class="common_title2">最近浏览</h3>
				<div class="has_view_list">
					<ul class="goods_type_list clearfix">
                        {% for goods in goods_list %}
                            <li>
                                <a href="{% url 'goods:detail' goods.id %}"><img src="{{ goods.goods_front_image }}"></a>
                                <h4><a href="{% url 'goods:detail' goods.id %}">{{ goods.name }}</a></h4>
                                <div class="operate">
                                    <span class="prize">￥{{ goods.shop_price }}</span>
                                    <span class="unit">{{ goods.shop_price }}/件</span>
                                    <a href="javascript:;" class="add_goods" title="加入购物车" onclick="add_cart({{ goods.id }});"></a>

                                </div>
                            </li>
                        {% endfor %}
                        <script type="text/javascript">
                            function add_cart(goods_id){
                                var csrf = $('input[name="csrfmiddlewaretoken"]').val()
                                $.ajax({
                                    url: '/cart/add_cart/',
                                    type: 'POST',
                                    dataType: 'json',
                                    headers: {'X-CSRFToken': csrf},
                                    data: {'goods_id': goods_id, 'goods_num': 1},
                                    success: function(data){
                                        if(data.code == '200'){
                                           alert('添加商品成功')
                                        }
                                    },
                                    error: function(data){
                                        alert('添加商品失败')
                                    }
                                })
                            }

                        </script>
                    </ul>
		        </div>
		</div>
	</div>



{% endblock %}